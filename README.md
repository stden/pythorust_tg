# 🚀 Telegram Automation Toolkit

> **Python + Rust** — мощные инструменты для автоматизации Telegram чатов

[![Python](https://img.shields.io/badge/Python-3.11+-3776AB?style=for-the-badge&logo=python&logoColor=white)](https://python.org)
[![Rust](https://img.shields.io/badge/Rust-1.70+-000000?style=for-the-badge&logo=rust&logoColor=white)](https://rust-lang.org)
[![Telegram](https://img.shields.io/badge/Telegram-MTProto-26A5E4?style=for-the-badge&logo=telegram&logoColor=white)](https://core.telegram.org/mtproto)
[![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)](LICENSE)

---

## 🎯 Какие задачи решает?

Этот тулкит — ваш швейцарский нож для работы с Telegram. Забудьте про ручную рутину!

### 📖 Чтение и экспорт чатов

| Функция | Описание |
|---------|----------|
| 📥 **Экспорт в Markdown** | Сохраняйте историю чатов с реакциями, эмодзи и метаданными |
| 📊 **Анализ вовлечённости** | Узнайте, какие сообщения собирают больше лайков и ответов |
| 🖼️ **Скачивание медиа** | Автоматическое сохранение фото/видео из популярных постов |
| 🔍 **Поиск пользователей** | Найдите любого участника чата по имени |
| 📋 **Список чатов** | Получите полный список ваших диалогов с метаданными |

### 🤖 AI-автоматизация

| Функция | Описание |
|---------|----------|
| 💬 **Умный автоответчик** | GPT-5.1/Gemini 2.5/Claude Sonnet 4.5 отвечает за вас |
| 🧠 **Контекстные реакции** | Бот ставит подходящие эмодзи в зависимости от содержания |
| 📝 **Linear интеграция** | Превращайте сообщения в задачи одной командой `!linear` |
| ❤️ **Массовые реакции** | Автоматически лайкайте сообщения нужных людей |
| 📋 **Промпты в Markdown** | Все системные промпты хранятся в `prompts/*.md` |

### 🧹 Автоочистка и гигиена

| Функция | Описание |
|---------|----------|
| 🗑️ **Удаление неинтересного** | Автоудаление ваших сообщений без реакций |
| 🔗 **Чистка Zoom-ссылок** | Удаляйте устаревшие ссылки на созвоны |
| 🚫 **Фильтрация спама** | Настраиваемые правила очистки |

### 🔧 DevOps и мониторинг

| Функция | Описание |
|---------|----------|
| 🌐 **Мониторинг сайтов** | Проверка доступности с уведомлениями в Telegram |
| ⚡ **HTTP бенчмарк** | Аналог `wrk` — тестируйте производительность API |
| 📈 **Алерты** | Мгновенные уведомления о проблемах |
| ☸️ **K8s Dashboard** | Простой CLI для управления Kubernetes (pods, logs, nodes) |

---

## 🦀 Почему Rust?

### Проблемы Python-библиотек

```
😤 Pyrogram — устарел, баги не фиксятся
😤 Telethon — медленный, жрёт память
😤 Нет поддержки новых API (gifts, stories, reactions)
```

### Решение: grammers 🦀

**grammers** — современный MTProto клиент на чистом Rust:

| Преимущество | Описание |
|--------------|----------|
| 🚀 **Скорость** | В 10-50x быстрее Python |
| 🪶 **Лёгкость** | Минимальное потребление RAM |
| ✨ **Актуальность** | Поддержка всех новых API Telegram |
| 🔒 **Type-safe** | Ошибки ловятся на этапе компиляции |
| 🎁 **Gifts API** | Работа с подарками (то, чего нет в Pyrogram!) |
| 📖 **Stories** | Полная поддержка историй |
| ⭐ **Reactions** | Все типы реакций включая premium |

### Сравнение производительности

```
┌─────────────────┬──────────┬──────────┐
│ Операция        │ Python   │ Rust     │
├─────────────────┼──────────┼──────────┤
│ Загрузка 1000   │ 12.3s    │ 0.8s     │
│ сообщений       │          │          │
├─────────────────┼──────────┼──────────┤
│ Экспорт чата    │ 8.5s     │ 0.3s     │
├─────────────────┼──────────┼──────────┤
│ RAM при работе  │ 150 MB   │ 12 MB    │
└─────────────────┴──────────┴──────────┘
```

---

## 📦 Установка

### Python (для быстрого старта)

```bash
# Рекомендуется: UV package manager
brew install uv  # или pip install uv
uv sync

# Классический способ
pip install -r requirements.txt
```

### Rust (для максимальной производительности)

```bash
cd rust_telegram
cargo build --release

# Бинарники появятся в target/release/
```

---

## 🔐 Настройка

### 1️⃣ Получите API credentials

1. Откройте https://my.telegram.org/
2. Войдите в свой аккаунт
3. Перейдите в "API Development Tools"
4. Создайте приложение
5. Сохраните `API_ID` и `API_HASH`

### 2️⃣ Создайте `.env` файл

```bash
cp .env.example .env
```

```env
# Обязательные
TELEGRAM_API_ID=12345678
TELEGRAM_API_HASH=abcdef1234567890
TELEGRAM_PHONE=+79001234567

# AI провайдеры (выберите нужные)
OPENAI_API_KEY=sk-...           # OpenAI GPT-5.1 (Nov 2025)
GOOGLE_API_KEY=AI...            # Google Gemini 2.5
ANTHROPIC_API_KEY=sk-ant-...    # Anthropic Claude Sonnet 4.5

# Интеграции
LINEAR_API_KEY=lin_api_...      # Linear для задач
```

### 3️⃣ Инициализация сессии

```bash
# ⚠️ Выполнить ОДИН раз!
uv run python init_session.py

# Введите код из Telegram
# Создастся файл telegram_session.session
```

> 💡 **Важно:** После инициализации вас выкинет из Telegram на других устройствах. Это нормально!

---

## 🚀 Использование

### 📋 Работа с чатами

```bash
# Список всех чатов
uv run python list_chats.py

# Экспорт чата в Markdown
uv run python read.py my_chat

# Быстрый экспорт (200 сообщений)
uv run python tg.py my_chat

# Экспорт личной переписки
uv run python export_chat.py @username
```

### 🤖 AI-автоматизация

```bash
# Запуск умного автоответчика
OPENAI_API_KEY=sk-... uv run python autoanswer.py

# Linear бот (создание задач из чата)
uv run python linear_bot.py

# В чате пишите:
# !linear Название задачи | Описание
```

### 🧹 Очистка

```bash
# Удаление ваших сообщений без реакций
uv run python delete_unanswered.py

# Удаление Zoom-ссылок
ZOOM_CLEANUP_CHATS="@user1,@user2" uv run python delete_zoom_messages.py

# Массовые реакции
LIKE_CHAT_ID=123456 LIKE_TARGET_USER_ID=789 uv run python like_messages.py
```

---

## 🦀 Rust версия

### Unified CLI

```bash
cd rust_telegram

# Список чатов
cargo run -- list-chats

# Чтение с удалением неинтересного
cargo run -- read my_chat --delete-unengaged

# Экспорт по username
cargo run -- export @username

# AI автоответчик
OPENAI_API_KEY=sk-... cargo run -- auto-answer

# Linear интеграция
LINEAR_API_KEY=... cargo run -- linear --title "Bug" --description "Steps"

# 📰 AI-дайджест чата (резюме за 24 часа)
cargo run -- digest my_chat --hours 24 --model gpt-4o-mini

# 🚫 Модерация мата (анализ без удаления)
cargo run -- profanity-stats my_chat --limit 1000

# Модерация с удалением (требуются права админа)
cargo run -- moderate my_chat --delete --warn

# 📊 CRM-парсинг (извлечение контактов и сделок)
cargo run -- crm my_chat --limit 100 --export-csv contacts.csv

# 🎯 Охота на пользователей по ключевым словам
cargo run -- hunt --chats chat1,chat2 --keywords "работа,вакансия" --required "python" --exclude "спам" --days 30 --export-csv results.csv
```

### Утилиты

```bash
# HTTP бенчмарк (аналог wrk)
cargo run --bin http_bench -- https://api.example.com -c 100 -d 10
# -c: количество соединений
# -d: длительность в секундах

# Мониторинг сайтов
cargo run --bin site_monitor -- check https://example.com
cargo run --bin site_monitor -- watch --interval 60

# K8s Dashboard
cargo run --bin k8s_dash -- pods default        # Pods в namespace
cargo run --bin k8s_dash -- logs my-pod -n app  # Логи pod
cargo run --bin k8s_dash -- nodes               # Статус nodes
cargo run --bin k8s_dash -- namespaces          # Список namespaces
```

---

## 📂 Структура проекта

```
📦 pythorust_tg/
│
├── 🐍 Python скрипты
│   ├── read.py              # 📖 Экспорт чатов с фильтрацией
│   ├── tg.py                # ⚡ Быстрый экспорт
│   ├── autoanswer.py        # 🤖 AI-автоответчик
│   ├── linear_bot.py        # 📝 Linear интеграция
│   ├── like_messages.py     # ❤️ Массовые реакции
│   ├── delete_unanswered.py # 🗑️ Очистка неинтересного
│   └── telegram_session.py  # 🔐 Управление сессиями
│
├── 🦀 rust_telegram/
│   ├── src/
│   │   ├── commands/        # Реализации команд
│   │   ├── lightrag/        # 🧠 RAG для знаний
│   │   ├── integrations/    # OpenAI, Gemini, Claude, Ollama
│   │   └── analysis/        # Vector DB, Graph DB
│   └── Cargo.toml
│
├── 📝 prompts/              # Системные промпты (Markdown)
│   ├── sales_agent.md       # Продавец-консультант
│   ├── moderator.md         # Модератор чата
│   ├── digest.md            # Создатель дайджестов
│   └── ...
│
├── 📝 config.yml            # Настройки чатов
└── 🔒 .env                  # Секреты (не в git!)
```

---

## ⚡ Матрица возможностей

| Функция | Python | Rust | Статус |
|---------|:------:|:----:|:------:|
| 📖 Чтение чатов | ✅ | ✅ | Готово |
| 📤 Экспорт в Markdown | ✅ | ✅ | Готово |
| 🤖 AI автоответчик | ✅ | ✅ | Готово |
| 📝 Linear интеграция | ✅ | ✅ | Готово |
| 🖼️ Скачивание медиа | ✅ | ✅ | Готово |
| 🗑️ Удаление сообщений | ✅ | ✅ | Готово |
| ❤️ Массовые реакции | ✅ | ✅ | Готово |
| 🌐 Мониторинг сайтов | ❌ | ✅ | Готово |
| ⚡ HTTP бенчмарк | ❌ | ✅ | Готово |
| 🧠 LightRAG | ❌ | ✅ | Готово |
| 📰 **Дайджест чата (AI)** | ❌ | ✅ | **NEW** |
| 🚫 **Модерация мата** | ❌ | ✅ | **NEW** |
| 📊 **CRM-парсинг** | ❌ | ✅ | **NEW** |
| 🎯 **Охота на пользователей** | ❌ | ✅ | **NEW** |
| ☁️ **AWS интеграция** | ✅ | ❌ | **NEW** |
| ☸️ **K8s Dashboard** | ❌ | ✅ | **NEW** |
| 🎁 Gifts API | ❌ | 🔜 | Планируется |
| 📖 Stories API | ❌ | 🔜 | Планируется |

---

## 🔒 Безопасность

```
✅ Единая SQLite сессия — никаких утечек токенов
✅ Блокировка параллельного запуска — защита от конфликтов
✅ Все секреты в .env — ничего не хардкодится
✅ Полный .gitignore — приватные файлы не попадут в репо
✅ Нет персональных данных в коде — safe to publish
```

---

## 💰 Монетизация: Как зарабатывать на этих инструментах

### 🤖 SaaS-сервисы на базе инструментария

| Бизнес-модель | Описание | Потенциал |
|---------------|----------|-----------|
| 💬 **AI-консьерж для бизнеса** | White-label автоответчик для компаний. Клиент платит за подписку, бот отвечает клиентам 24/7 | $50-500/мес за клиента |
| 📊 **Аналитика чатов** | Дашборд с метриками вовлечённости, активности, sentiment-анализом для комьюнити-менеджеров | $30-100/мес |
| 📝 **Telegram → Задачи** | Интеграция с Linear/Jira/Notion — превращайте сообщения в тикеты одной командой | $10-50/мес |
| 🗂️ **Архиватор чатов** | Автоматический экспорт и бэкап истории с поиском и индексацией | $5-20/мес |

### 🛠️ Услуги и консалтинг

| Услуга | Описание | Ставка |
|--------|----------|--------|
| ⚙️ **Настройка автоматизации** | Развёртывание и кастомизация под клиента | $500-2000 разово |
| 🔧 **Кастомная разработка** | Новые фичи, интеграции, боты под заказ | $50-150/час |
| 📈 **Аудит Telegram-каналов** | Анализ вовлечённости, рекомендации по росту | $200-500 за отчёт |
| 🎓 **Обучение** | Курсы/воркшопы по автоматизации Telegram | $100-500 за участника |

### 🚀 Готовые продукты

```
┌─────────────────────────────────────────────────────────────────┐
│  🎯 Ниши с высоким спросом                                      │
├─────────────────────────────────────────────────────────────────┤
│  • Инфобизнес — автоответы на вопросы учеников                  │
│  • E-commerce — поддержка клиентов в Telegram                   │
│  • HR/рекрутинг — первичный скрининг кандидатов                 │
│  • Недвижимость — бот-консультант по объектам                   │
│  • Медицина — запись на приём, напоминания                      │
│  • Event-менеджмент — регистрация, уведомления                  │
└─────────────────────────────────────────────────────────────────┘
```

### 📊 Модели монетизации

#### Подписка (SaaS)
```
Стартер:   $29/мес  — 1 бот, 1000 сообщений/мес
Бизнес:    $99/мес  — 5 ботов, 10000 сообщений/мес
Enterprise: $299/мес — безлимит, приоритетная поддержка
```

#### Pay-per-use
```
$0.01 за обработанное сообщение
$0.10 за AI-ответ (GPT-4)
$1.00 за экспорт чата (до 10000 сообщений)
```

#### Freemium + Upsell
```
🆓 Бесплатно: базовый экспорт, 100 сообщений/день
💎 Premium: AI-ответы, аналитика, интеграции
```

### 💡 Идеи для быстрого старта

1. **Бот записи на консультации**
   - Клиент выбирает слот → бот бронирует → напоминание за час
   - Интеграция с Calendly/Cal.com
   - Монетизация: % от консультации или подписка

2. **Автодайджест для каналов**
   - Ежедневная/недельная сводка самых важных сообщений
   - AI-резюме обсуждений
   - Монетизация: $10-30/мес за канал

3. **Модератор-бот**
   - Автоудаление спама, Zoom-ссылок, рекламы
   - Предупреждения нарушителям
   - Монетизация: $5-15/мес за чат

4. **Lead-генератор**
   - Сбор контактов из чатов в CRM
   - Квалификация лидов по активности
   - Монетизация: $0.10-1.00 за лид

### 🔥 Конкурентные преимущества

```
✅ Rust-производительность — обработка тысяч чатов одновременно
✅ Низкие затраты на инфраструктуру — 12 МБ RAM vs 150 МБ у конкурентов
✅ Поддержка новых API — gifts, stories, premium-реакции
✅ Self-hosted — данные клиента остаются у клиента
✅ Open-source ядро — доверие и кастомизация
```

### 📈 Примерный ROI

| Инвестиции | Потенциальный доход | Срок окупаемости |
|------------|---------------------|------------------|
| VPS $20/мес + время | 10 клиентов × $50 = $500/мес | 1-2 месяца |
| Разработка $2000 | 50 клиентов × $30 = $1500/мес | 2-3 месяца |
| Маркетинг $500/мес | 100+ клиентов = $3000+/мес | 1 месяц |

---

## 🛠️ Разработка

### Запуск тестов

```bash
# Python
uv run pytest -v

# Rust (63 теста)
cd rust_telegram && cargo test --lib
```

### Линтинг

```bash
# Rust
cargo fmt --all -- --check
cargo clippy --all-targets -- -D warnings
```

---

## 📚 Документация

| Документ | Описание |
|----------|----------|
| [CLAUDE.md](CLAUDE.md) | Полная техническая документация |
| [rust_telegram/README.md](rust_telegram/README.md) | Документация Rust версии |
| [codev/](codev/) | Спецификации и планы развития |

---

## 🤝 Contributing

Это open-source проект! PRs приветствуются 🎉

1. Fork репозитория
2. Создайте feature branch
3. Commit ваши изменения
4. Push в branch
5. Откройте Pull Request

---

<div align="center">

**⭐ Star this repo if you find it useful!**

Made with ❤️ and 🦀

</div>
